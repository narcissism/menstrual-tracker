<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Period Tracker - Jan 2026</title>
<style>
body { font-family: sans-serif; margin:0; background:#fff; display:flex; flex-direction:column; align-items:center; }
#calendar { display:grid; grid-template-columns: repeat(7, 60px); gap:5px; margin-top:20px; }
.day { width:60px; height:60px; border:1px solid #ccc; display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer; position:relative; font-size:12px; }
.day.period { background:#fdd; }
.day.ovulation { background:#ffd; }
.moon { position:absolute; bottom:2px; font-size:14px; }
#modal { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; border:1px solid #333; padding:20px; z-index:10; }
#modal select { margin-bottom:10px; width:100%; }
#analysis { margin-top:20px; width:80%; }
</style>
</head>
<body>

<h1>Period Tracker - January 2026</h1>
<div id="calendar"></div>

<div id="modal">
  <h3>Track Day</h3>
  <label>Period: <input type="checkbox" id="periodCheck"></label><br>
  <label>Mood:
    <select id="moodSelect">
      <option value="">--</option>
      <option value="Happy">Happy</option>
      <option value="Irritable">Irritable</option>
      <option value="Sad">Sad</option>
      <option value="Anxious">Anxious</option>
    </select>
  </label><br>
  <label>Symptoms:
    <select id="symptomSelect" multiple size=4>
      <option value="Cramps">Cramps</option>
      <option value="Bloating">Bloating</option>
      <option value="Headache">Headache</option>
      <option value="Fatigue">Fatigue</option>
    </select>
  </label><br>
  <button id="saveBtn">Save</button>
  <button id="closeBtn">Close</button>
</div>

<div id="analysis">
  <h2>Analysis</h2>
  <div id="cycleLength"></div>
  <div id="periodLength"></div>
  <div id="symptomTrends"></div>
  <div id="phaseInfo"></div>
</div>

<script>
// DATA
let entries = {}; // YYYY-MM-DD
const calendar = document.getElementById('calendar');
let selectedDate = null;

// MONTH SETTINGS
const currentYear = 2026;
const currentMonth = 0; // January
const firstDay = new Date(currentYear, currentMonth, 1);
const lastDay = new Date(currentYear, currentMonth+1,0);

// MOON PHASE ICONS
function moonIcon(date){
  const c = new Date(date).getTime() / 86400000;
  const phase = ((c + 4.867) % 29.53059) / 29.53059;
  if(phase < 0.03 || phase > 0.97) return 'ðŸŒ‘'; // New
  if(phase < 0.22) return 'ðŸŒ’'; // Waxing
  if(phase < 0.28) return 'ðŸŒ“'; // First Quarter
  if(phase < 0.47) return 'ðŸŒ”'; // Waxing Gibbous
  if(phase < 0.53) return 'ðŸŒ•'; // Full
  if(phase < 0.72) return 'ðŸŒ–'; // Waning Gibbous
  if(phase < 0.78) return 'ðŸŒ—'; // Last Quarter
  return 'ðŸŒ˜'; // Waning
}

// CALENDAR BUILD
function buildCalendar(){
  calendar.innerHTML='';
  const startDay = firstDay.getDay();
  for(let i=0;i<startDay;i++){
    calendar.appendChild(document.createElement('div'));
  }
  for(let d=1;d<=lastDay.getDate();d++){
    const date = new Date(currentYear,currentMonth,d);
    const key = date.toISOString().split('T')[0];
    const div = document.createElement('div');
    div.className='day';
    div.dataset.date = key;
    div.innerHTML = `<span>${d}</span><span class="moon">${moonIcon(date)}</span>`;
    if(entries[key]){
      if(entries[key].period) div.classList.add('period');
      else if(entries[key].phase==='ovulation') div.classList.add('ovulation');
    }
    div.onclick = ()=>openModal(key);
    calendar.appendChild(div);
  }
}

// MODAL
const modal = document.getElementById('modal');
const periodCheck = document.getElementById('periodCheck');
const moodSelect = document.getElementById('moodSelect');
const symptomSelect = document.getElementById('symptomSelect');
document.getElementById('saveBtn').onclick = ()=>{
  entries[selectedDate] = {
    period: periodCheck.checked,
    mood: moodSelect.value,
    symptoms: Array.from(symptomSelect.selectedOptions).map(o=>o.value)
  };
  modal.style.display='none';
  assignPhases();
  buildCalendar();
  updateAnalysis();
};
document.getElementById('closeBtn').onclick = ()=>{ modal.style.display='none'; }
function openModal(date){
  selectedDate = date;
  const entry = entries[date] || {period:false,mood:'',symptoms:[]};
  periodCheck.checked = entry.period;
  moodSelect.value = entry.mood;
  Array.from(symptomSelect.options).forEach(o=>o.selected=entry.symptoms.includes(o.value));
  modal.style.display='block';
}

// ANALYSIS
function updateAnalysis(){
  const keys = Object.keys(entries).sort();
  const periodStarts = keys.filter(k=>entries[k].period).map(k=>new Date(k));
  // cycle length
  let cycles=[];
  for(let i=1;i<periodStarts.length;i++) cycles.push(Math.round((periodStarts[i]-periodStarts[i-1])/(1000*60*60*24)));
  document.getElementById('cycleLength').innerText = cycles.length>0 ? `Average cycle length: ${Math.round(cycles.reduce((a,b)=>a+b,0)/cycles.length)} days` : 'Average cycle length: N/A';
  // period length
  let lengths=[];
  for(let i=0;i<periodStarts.length;i++){
    let start = periodStarts[i];
    let count=1;
    for(let j=1;j<keys.length;j++){
      const next = new Date(keys[j]);
      if(next>start && entries[keys[j]]?.period) count++;
      else break;
    }
    lengths.push(count);
  }
  document.getElementById('periodLength').innerText = lengths.length>0 ? `Average period length: ${Math.round(lengths.reduce((a,b)=>a+b,0)/lengths.length)} days` : 'Average period length: N/A';
  // symptom trends
  const symptomCounts={};
  for(let k of keys){
    if(entries[k]?.symptoms) entries[k].symptoms.forEach(s=>{
      symptomCounts[s] = (symptomCounts[s]||0)+1;
    });
  }
  document.getElementById('symptomTrends').innerText = 'Symptom frequency: '+Object.entries(symptomCounts).map(([s,c])=>`${s}: ${c}`).join(', ');
  // phase info
  const phases = ['Menstrual','Follicular','Ovulation','Luteal'];
  document.getElementById('phaseInfo').innerText = 'Phase info: '+phases.join(', ');
}

// SIMPLE CYCLE PHASE ASSIGNMENT
function assignPhases(){
  const keys = Object.keys(entries).sort();
  const periodStarts = keys.filter(k=>entries[k].period).map(k=>new Date(k));
  if(periodStarts.length<2) return;
  const cycleLength = Math.round((periodStarts[1]-periodStarts[0])/(1000*60*60*24));
  for(let i=0;i<keys.length;i++){
    const d = new Date(keys[i]);
    const daysSinceStart = Math.round((d-periodStarts[0])/(1000*60*60*24));
    if(entries[keys[i]].period) entries[keys[i]].phase='Menstrual';
    else if(daysSinceStart>=cycleLength*0.5-1 && daysSinceStart<=cycleLength*0.5+1) entries[keys[i]].phase='Ovulation';
    else if(daysSinceStart<cycleLength*0.5) entries[keys[i]].phase='Follicular';
    else entries[keys[i]].phase='Luteal';
  }
}

// INIT
buildCalendar();
updateAnalysis();
</script>
</body>
</html>
